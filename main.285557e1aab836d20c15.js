"use strict";(self.webpackChunkwebpack_demo=self.webpackChunkwebpack_demo||[]).push([[179],{424:(t,e,i)=>{i.d(e,{Z:()=>h});var s=i(81),n=i.n(s),o=i(645),a=i.n(o)()(n());a.push([t.id,"body {\r\n  background-color: #121212;\r\n  color: #fff;\r\n}\r\n\r\n.canvas {\r\n  background-color: #1e1e1e;\r\n  border: 5px solid #fff;\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  height: 100%;\r\n  max-width: 300px;\r\n  max-height: 600px;\r\n  border-radius: 32px;\r\n}\r\n",""]);const h=a},548:(t,e,i)=>{i.r(e),i.d(e,{default:()=>x});var s=i(379),n=i.n(s),o=i(795),a=i.n(o),h=i(569),r=i.n(h),d=i(565),l=i.n(d),c=i(216),p=i.n(c),g=i(589),u=i.n(g),m=i(424),f={};f.styleTagTransform=u(),f.setAttributes=l(),f.insert=r().bind(null,"head"),f.domAPI=a(),f.insertStyleElement=p(),n()(m.Z,f);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},630:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Background=e.BACKGROUND_UPDATE_INDEX=void 0;const s=i(117);e.BACKGROUND_UPDATE_INDEX=400,e.Background=class{constructor({game:t,size:i,image:n,displacementMultipliers:o}){this.game=t,this.game.onUpdate(e.BACKGROUND_UPDATE_INDEX,(()=>this.update())),this.size=i instanceof s.Size?i:new s.Size(i),this.image=new Image,this.image.src=n,this.displacementMultipliers={x:1,y:1},Object.assign(this.displacementMultipliers,o)}update(){let t=-this.game.view.position.x*this.displacementMultipliers.x;for(;t+this.size.width<0;)t+=this.size.width;for(;0<t;)t-=this.size.width;const e=Math.ceil(this.game.view.width/this.size.width)+1;for(let i=0;i<e;i++)this.game.view.drawImage({image:this.image,sx:0,sy:0,sw:this.size.width,sh:this.size.height,tx:t+i*this.size.width,ty:0,tw:this.size.width,th:this.size.height,type:"absolute"})}}},237:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CircleCollider=void 0;const s=i(673),n=i(526);class o extends s.Collider{constructor({position:t,size:e}){super({position:t,size:e}),this.radius=(this.size.height+this.size.width)/4}getArea(){return Math.PI*this.radius**2}getCenter(){return new n.Position({x:this.position.x+this.radius,y:this.position.y+this.radius})}getRect(){return{left:this.position.x,right:this.position.x+2*this.radius,bottom:this.position.y,top:this.position.y+2*this.radius}}}e.CircleCollider=o},673:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Collider=void 0;const s=i(614),n=i(526),o=i(117);e.Collider=class{constructor({position:t,size:e}){this.id=(0,s.v4)(),this.position=t instanceof n.Position?t:new n.Position(t),this.size=e instanceof o.Size?e:new o.Size(e)}getArea(){return 0}getCenter(){return new n.Position({x:0,y:0})}}},367:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RectangleCollider=void 0;const s=i(673),n=i(526);class o extends s.Collider{constructor({position:t,size:e}){super({position:t,size:e})}getArea(){return this.size.width*this.size.height}getCenter(){return new n.Position({x:this.position.x+this.size.width/2,y:this.position.y+this.size.height/2})}getRect(){return{left:this.position.x,right:this.position.x+this.size.width,bottom:this.position.y,top:this.position.y+this.size.height}}}e.RectangleCollider=o},908:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CollisionObserver=e.COLLISION_UPDATE_INDEX=void 0;const s=i(237),n=i(367),o=i(638),a=i(34),h=i(949);e.COLLISION_UPDATE_INDEX=100,e.CollisionObserver=class{constructor({game:t,rootCollider:i}){this.game=t,this.game.onUpdate(e.COLLISION_UPDATE_INDEX,(()=>this.update())),this.root=i,this.targets=[],this.isIntersecting={}}onCollisionWith(t,e,i){this.targets.push({target:t,enterHandler:e,leaveHandler:i})}removeObservation(t){const e=this.targets.findIndex((({target:e})=>e.id!==t.id));this.targets.splice(e)}update(){const t=this.root;this.targets.forEach((({target:e,enterHandler:i,leaveHandler:r})=>{let d;t instanceof n.RectangleCollider?e instanceof n.RectangleCollider?d=(0,a.rectanglesIntersection)(t,e):e instanceof s.CircleCollider&&(d=(0,h.rectangleCircleIntersection)(t,e)):t instanceof s.CircleCollider&&(e instanceof n.RectangleCollider?d=(0,h.rectangleCircleIntersection)(e,t):e instanceof s.CircleCollider&&(d=(0,o.circlesIntersection)(t,e))),void 0!==d&&(!this.isIntersecting[e.id]&&d&&i(this.root,e),this.isIntersecting[e.id]&&!d&&(null==r||r(this.root,e)),this.isIntersecting[e.id]=d)}))}}},638:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.circlesIntersection=void 0,e.circlesIntersection=function(t,e){const i=t.getCenter(),s=e.getCenter();return Math.sqrt((i.x-s.x)**2+(i.y-s.y)**2)<t.radius+e.radius}},949:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.rectangleCircleIntersection=void 0,e.rectangleCircleIntersection=function(t,e){const i=t.getCenter(),s=e.getCenter(),n=Math.abs(i.x-s.x),o=Math.abs(i.y-s.y);return!(n>t.size.width/2+e.radius||o>t.size.height/2+e.radius)&&(n<=t.size.width/2||o<=t.size.height/2||Math.sqrt((n-t.size.width/2)**2+(o-t.size.height/2)**2)<=e.radius)}},34:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.rectanglesIntersection=void 0,e.rectanglesIntersection=function(t,e){const i=t.getRect(),s=e.getRect();return!(i.right<s.left||s.right<i.left||i.top<s.bottom||s.top<i.bottom)}},634:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GameElement=e.GAME_ELEMENT_UPDATE_INDEX=void 0;const s=i(237),n=i(367),o=i(908),a=i(488),h=i(526),r=i(117),d=i(655);e.GAME_ELEMENT_UPDATE_INDEX=200,e.GameElement=class{constructor({game:t,position:i,size:l,physics:c,sprite:p,collider:g}){this.game=t,this.position=new h.Position(i),this.size=new r.Size(l),this.physics=new a.Physics(Object.assign({game:this.game,position:this.position},c)),this.game.onUpdate(e.GAME_ELEMENT_UPDATE_INDEX,(()=>this.update())),this.collider="circle"===(null==g?void 0:g.shape)?new s.CircleCollider(Object.assign({position:this.position,size:this.size},g)):new n.RectangleCollider(Object.assign({position:this.position,size:this.size},g)),this.collisionObserver=new o.CollisionObserver({game:this.game,rootCollider:this.collider}),this.sprite=new d.Sprite(Object.assign({game:this.game,position:this.position,size:this.size},p)),this.onUpdateHandlers=[]}onCollisionWith(t,e,i){(Array.isArray(t)?t:[t]).forEach((t=>{this.collisionObserver.onCollisionWith(t,e,i)}))}onUpdate(t){this.onUpdateHandlers.push(t)}update(){this.onUpdateHandlers.forEach((t=>t()))}}},223:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;const s=i(416);e.Game=class{constructor(t){this.handleKeyDown=t=>{this.pressedKeys[t.key]=!0},this.handleKeyUp=t=>{this.pressedKeys[t.key]=!1},this.handleTouchStart=t=>{this.pressedKeys.touch=!0},this.handleTouchEnd=t=>{this.pressedKeys.touch=!1},this.state="stoped",this.view=new s.View(t),this.onStartHandlers=[],this.onStopHandlers=[],this.onUpdateHandlers=[],this.frame=0,this.timeSpeed=1,this.realTime=0,this.time=0,this.deltaTime=0,this.pressedKeys={},window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("touchstart",this.handleTouchStart),window.addEventListener("touchend",this.handleTouchEnd)}onStart(t,e){let i=this.onStartHandlers.findIndex((([,e])=>e>t));-1===i&&(i=this.onStartHandlers.length),this.onStartHandlers.splice(i,0,[e,t])}onStop(t,e){let i=this.onStopHandlers.findIndex((([,e])=>e>t));-1===i&&(i=this.onStopHandlers.length),this.onStopHandlers.splice(i,0,[e,t])}onUpdate(t,e){let i=this.onUpdateHandlers.findIndex((([,e])=>e>t));-1===i&&(i=this.onUpdateHandlers.length),this.onUpdateHandlers.splice(i,0,[e,t])}start(){Object.assign(this,{state:"started",frame:0,realTime:(new Date).valueOf(),time:(new Date).valueOf(),deltaTime:0}),this.onStartHandlers.forEach((([t])=>t())),this.update()}stop(){Object.assign(this,{state:"stoped"}),this.onStopHandlers.forEach((([t])=>t()))}update(){const t=(new Date).valueOf();this.view.clear();const e=t-this.realTime,i=Math.round(e*this.timeSpeed);Object.assign(this,{deltaTime:i,realTime:t,time:this.time+i}),this.onUpdateHandlers.forEach((([t])=>t())),Object.assign(this,{frame:this.frame+1}),"started"===this.state&&requestAnimationFrame((()=>this.update()))}setTimeSpeed(t){Object.assign(this,{timeSpeed:t})}}},488:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Physics=e.PHYSICS_UPDATE_INDEX=void 0;const s=i(526);e.PHYSICS_UPDATE_INDEX=300,e.Physics=class{constructor({game:t,position:i,speed:n,acceleration:o,maxSpeed:a,friction:h}){this.game=t,this.game.onUpdate(e.PHYSICS_UPDATE_INDEX,(()=>this.update())),this.position=i instanceof s.Position?i:new s.Position(i),this.speed={x:(null==n?void 0:n.x)||0,y:(null==n?void 0:n.y)||0},this.acceleration={x:(null==o?void 0:o.x)||0,y:(null==o?void 0:o.y)||0},this.maxSpeed="number"==typeof a?{x:a,y:a}:{x:(null==a?void 0:a.x)||0,y:(null==a?void 0:a.y)||0},this.friction="number"==typeof h?{x:h,y:h}:{x:(null==h?void 0:h.x)||0,y:(null==h?void 0:h.y)||0}}setSpeed(t){Object.assign(this.speed,t)}setAcceleration(t){Object.assign(this.acceleration,t)}setMaxSpeed(t){Object.assign(this.maxSpeed,t)}setFriction(t){Object.assign(this.friction,t)}update(){const t={x:this.speed.x+this.acceleration.x*this.game.deltaTime,y:this.speed.y+this.acceleration.y*this.game.deltaTime};if(this.friction.x){const e=this.friction.x*this.game.deltaTime;t.x>e?t.x=t.x-e:t.x<-e?t.x=t.x+e:t.x=0}if(this.friction.y){const e=this.friction.y*this.game.deltaTime;t.y>e?t.y=t.y-e:t.y<-e?t.y=t.y+e:t.y=0}this.maxSpeed.x&&(t.x>this.maxSpeed.x&&(t.x=this.maxSpeed.x),t.x<-this.maxSpeed.x&&(t.x=-this.maxSpeed.x)),this.maxSpeed.y&&(t.y>this.maxSpeed.y&&(t.y=this.maxSpeed.y),t.y<-this.maxSpeed.y&&(t.y=-this.maxSpeed.y)),Object.assign(this.speed,t),this.position.setPosition({x:this.position.x+this.speed.x*this.game.deltaTime,y:this.position.y+this.speed.y*this.game.deltaTime})}}},526:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Position=void 0,e.Position=class{constructor(t){this.x=(null==t?void 0:t.x)||0,this.y=(null==t?void 0:t.y)||0}setPosition(t){Object.assign(this,t)}translate({x:t=0,y:e=0}){Object.assign(this,{x:this.x+t,y:this.y+e})}}},117:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Size=void 0,e.Size=class{constructor(t){this.width=(null==t?void 0:t.width)||0,this.height=(null==t?void 0:t.height)||0}setSize(t){Object.assign(this,t)}scale(t){Object.assign(this,{width:this.width*t,height:this.height*t})}}},655:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=e.SPRITE_UPDATE_INDEX=void 0;const s=i(526),n=i(117);e.SPRITE_UPDATE_INDEX=500,e.Sprite=class{constructor({game:t,position:i,size:o,image:a,animations:h,fps:r=24,defaultAnimation:d}){this.game=t,this.game.onUpdate(e.SPRITE_UPDATE_INDEX,(()=>this.update())),this.game.onStart(e.SPRITE_UPDATE_INDEX,(()=>this.onGameStart())),this.position=i instanceof s.Position?i:new s.Position(i),this.size=o instanceof n.Size?o:new n.Size(o),this.image=new Image,this.image.src=a,this.animations=h,this.fpms=r/1e3,this.animation=d||Object.keys(h)[0],this.timeOffset=0,this.frameIndex=0}onGameStart(){Object.assign(this,{timeOffset:this.game.time,frameIndex:0})}update(){const t=Math.floor((this.game.time-this.timeOffset)*this.fpms);Object.assign(this,{frameIndex:t>this.frameIndex?t:this.frameIndex});const e=this.animations[this.animation],i=e[this.frameIndex%e.length];this.game.view.drawImage({image:this.image,sx:i.x,sy:i.y,sw:this.size.width,sh:this.size.height,tx:this.position.x,ty:this.position.y,tw:this.size.width,th:this.size.height})}setAnimation(t){Object.assign(this,{timeOffset:this.game.time,animation:t})}}},416:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;const s=i(526);e.View=class{constructor(t){this.canvas=t;const e=this.canvas.getContext("2d");if(!e)throw new Error("could not get the CanvasRenderingContext2D");this.ctx=e,this.position=new s.Position({x:0,y:0})}get width(){return this.canvas.width}get height(){return this.canvas.height}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}drawImage({image:t,sx:e,sy:i,sw:s,sh:n,tx:o,ty:a,tw:h,th:r,type:d="relative"}){a=this.canvas.height-r-a,"relative"===d&&(o-=this.position.x,a-=this.position.y),this.ctx.drawImage(t,e,i,s,n,o,a,h,r)}drawText({text:t,tx:e,ty:i,color:s="#000",fontFamily:n="Arial",fontSize:o=30,fontWeight:a="normal",textAlign:h="left"}){i=this.canvas.height-o-i,this.ctx.fillStyle=s,this.ctx.font=`${a} ${o}px ${n}`,this.ctx.textAlign=h,this.ctx.fillText(t,e,i)}}},151:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||s(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(i(223),e),n(i(526),e),n(i(117),e),n(i(416),e),n(i(488),e),n(i(673),e),n(i(367),e),n(i(237),e),n(i(908),e),n(i(630),e),n(i(655),e),n(i(634),e),n(i(36),e),n(i(861),e)},36:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isCanvas=void 0,e.isCanvas=function(t){return"CANVAS"===t.tagName}},861:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.movingAverage=void 0,e.movingAverage=function(t=30){const e=[];return i=>{for(e.push(i);e.length>t;)e.shift();const s=e.reduce(((t,e)=>t+e));return s/e.length}}},607:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),i(548);const n=i(151),o=s(i(463)),a=s(i(868)),h=s(i(681));let r=0,d="start",l=48,c=1,p=Math.PI/2,g=Math.floor(8*Math.random());const u=document.getElementById("canvas");if(!u)throw new Error("canvas element not found");if(!(0,n.isCanvas)(u))throw new Error("the element must be a canvas");const m=new n.Game(u),f=(new n.Sprite({game:m,position:{x:m.view.width/2-32,y:m.view.height/2-32},size:{width:64,height:64},image:o.default,fps:12,animations:{idle:[{x:0,y:0}]}}),new n.GameElement({game:m,position:{x:m.view.width/2-8+Math.cos(p)*l,y:m.view.height/2-8+Math.sin(p)*l},size:{width:16,height:16},sprite:{image:a.default,fps:12,animations:{idle:[{x:0,y:0}]}},collider:{shape:"circle"}})),x=Array.from({length:8},((t,e)=>{let i=Math.PI*e*2/8;const s=new n.GameElement({game:m,size:{width:32,height:32},position:{x:m.view.width/2-16+128*Math.cos(i),y:m.view.height/2-16+128*Math.sin(i)},sprite:{image:h.default,fps:12,animations:{inactive:[{x:0,y:0}],active:[{x:0,y:32}]},defaultAnimation:g===e?"active":"inactive"},collider:{shape:"circle"}});return s.onCollisionWith(f.collider,(()=>{if(g===e){let t;for(r++,d="return",x[g].sprite.setAnimation("inactive");void 0===t||t===g;)t=Math.floor(8*Math.random());g=t,x[g].sprite.setAnimation("active"),c=-c}else m.stop()})),s.onUpdate((()=>{const t=Math.floor(Math.log(r||1)/Math.log(2));i+=t*(Math.PI*m.deltaTime/8e3)*Math.sin(Math.PI*m.time/5e3),s.position.setPosition({x:m.view.width/2-16+128*Math.cos(i),y:m.view.height/2-16+128*Math.sin(i)})})),s}));f.onUpdate((()=>{m.view.drawText({text:`${r}`,tx:150,ty:m.view.height-130,color:"#fff",textAlign:"center",fontWeight:"bolder",fontSize:45});const t=m.pressedKeys[" "]||m.pressedKeys.touch;switch("start"===d&&t&&(d="shoted"),"return"===d&&l<=48&&(d="start",l=48),d){case"start":p+=c*(Math.PI*m.deltaTime)/2e3;break;case"shoted":l+=5;break;case"return":l-=10}f.position.setPosition({x:m.view.width/2-f.size.width/2+Math.cos(p)*l,y:m.view.height/2-f.size.height/2+Math.sin(p)*l}),(f.position.x<0||f.position.x+f.size.width>m.view.width||f.position.y<0||f.position.y+f.size.height>m.view.height)&&m.stop()})),m.start()},868:(t,e,i)=>{t.exports=i.p+"d961df7ee330000c96f3.png"},463:(t,e,i)=>{t.exports=i.p+"1052eded401433f59886.png"},681:(t,e,i)=>{t.exports=i.p+"b5caca346a3379696d9e.png"}},t=>{t.O(0,[216],(()=>(607,t(t.s=607)))),t.O()}]);